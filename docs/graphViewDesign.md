## 核心设计目标:
1. 对相关节点进行归类(按照关系类型)后展示
   1. 参考the brain的层级布局
   2. 将节点布局页面分为上下左右四个区域
      1. 分为四个关系组(上下左右关系组), 每个关系组可以配置多种关系类型
         1. 配置了其他关系类型的关系组, 将显示未被其他关系组配置的关系类型
      2. 默认上面是father关系(可以称为up关系组, 其他关系组同理),下面是child关系
      3. 默认左边是base关系, 右边是build关系
      4. 每个区域所展示的区域可以另外配置
   3. 支持深层显示
      1. 针对中心节点, 显示father的up关系组, 但不显示father的其他关系组, 然后递归的显示, 直到指定的层数
      2. 递归节点之间也要符合布局的层级位置关系
         1. 如father的father节点要显示在father节点的上方区域
2. 知识图谱的可视化增删改查功能(单页面应用, 不用跳转到其他页面)
   1. 可以新建一个独立节点并切换视图到该节点, 并编辑该节点名称, 放在更多菜单(右上角的三个横杠)里
   2. 对于当前中心节点, 可以在中心节点的菜单中选择创建默认的四种关系,分别为四个选项, 还有一个选项是创建"自定义联系", 然后弹出并自动聚焦到输入框, 输入联系的名称, 然后回车, 即可创建一个自定义关系; 以上创建完关系后, 自动在终点创建一个节点, 并把输入焦点到该节点的名称输入框, 但不切换中心节点
   3. 对于任意节点, 对其编辑时(右键菜单触发), 显示输入框(中央弹窗显示), 输入框自动聚焦, 输入框内容为当前节点名称, 输入框失去焦点时, 自动保存
   4. 对于任意关系, 对其编辑时, 也变成输入框, 且具有以下功能:
      1. 可以根据已有的关系, 进行自动补全
         1. 仅在编辑完整关系类型时才自动补全
      2. 根据当前的关系标签显示类型, 修改对应的目标(如简短就修改关系的缩写属性, 完整就对应该关系的类型)
   5. 右键任意节点和关系, 显示对应的菜单
      1. 尽量用IONIC的组件
      2. 不要用弹窗, 而是像原生的右键菜单那样的
   6. 删除放到节点和关系菜单中

## 细节
- 节点之间的连线起点与终点都应该在节点边框(并且要符合层级关系, 如上下层级就应该连接上下边框, 左右层级同理), 而不是中心


## 实现方案

本项目使用 X6 图形库实现了一个四象限布局的图形可视化组件。

### 关键组件

1. **GraphNode 模型**:
   - 定义了节点和边的数据结构，包含 id、label、type、is_independent、metadata、depth 等字段。
   - 支持多种关系类型，系统内置 FATHER、CHILD、BASE、BUILD 等常见类型，支持自定义。

2. **GraphLayoutService**:
   - `organizeByQuadrants`：根据关系类型和深度递归分组节点，支持多层级递归。
   - `calculateQuadrantLayout`：根据象限和层级计算节点的精确坐标，自动避免重叠。
   - `resolveNodeOverlaps`：碰撞检测与位置调整，保证节点布局美观。
   - 支持象限、深度、关系类型的灵活配置。

3. **GraphView 组件**:
   - 使用 X6 渲染节点和连接线，支持四象限递归布局。
   - 支持节点点击切换焦点、右键菜单、节点/关系编辑、自动聚焦新节点。
   - 关系类型、节点类型、象限、深度等均可配置。
   - 右键菜单和编辑弹窗广泛使用 IONIC 组件，体验接近原生。

4. **节点和关系编辑组件**:
   - **NodeEditModal**：弹窗编辑节点名称，自动聚焦，失焦自动保存。
   - **EdgeEditModal**：编辑关系类型，支持自动补全和多标签模式，实时预览。

### 功能特点

1. **四象限递归布局**：
   - 中心节点居中，四象限根据关系类型递归分组，支持多层级递归。
   - 节点布局自动避免重叠，支持自定义象限和深度配置。

2. **交互功能**：
   - 点击节点切换中心，右键菜单支持节点/关系编辑、删除。
   - 节点/关系编辑支持自动补全、自动聚焦。
   - 右键菜单和弹窗均为 IONIC 组件，体验流畅。

3. **编辑功能**：
   - 节点编辑弹窗自动聚焦，失焦自动保存。
   - 关系编辑支持自动补全和多标签模式，实时预览。

4. **视觉样式**：
   - 中心节点橙色，FATHER 绿色，CHILD 蓝色，BASE 紫色，BUILD 红色。

## 配置说明

- **象限配置**：可自定义每个象限显示的关系类型，未配置类型可指定默认象限。
- **深度配置**：可为每种关系类型设置递归深度，默认 3 层。
- **视图配置**：支持关系标签显示模式（无、简洁、完整）、自动聚焦新节点、开发者模式等。

## 主要数据结构

- GraphNode: { id, label, type, is_independent, metadata, depth, ... }
- GraphEdge: { id, source, target, relationshipType, metadata }
- QuadrantConfig, DepthConfig, ViewConfig: 详见 models/GraphNode.ts

## 经验总结
- 布局服务需兼顾递归分组、碰撞检测、象限分布。
- 交互需区分用户操作与程序自动操作，避免误删。
- 右键菜单、弹窗等交互建议统一用 IONIC 组件。

## 细节
- 节点之间的连线起点与终点都应该在节点边框(并且要符合层级关系, 如上下层级就应该连接上下边框, 左右层级同理), 而不是中心

## 使用说明

可以通过 `GraphViewDemo` 页面查看实现效果。该页面提供了一个演示数据集和象限配置界面，允许用户切换不同象限显示的关系类型。

### 象限配置

用户可以通过界面上的下拉选择框自定义每个象限显示的关系类型，实现灵活的视图配置。

### 节点和关系编辑

- 右键点击节点: 打开节点编辑菜单，可以选择编辑节点名称
- 右键点击关系线: 打开关系编辑菜单，可以修改关系类型

编辑关系时，系统会根据当前配置的标签显示模式（无标签、简短标签、完整标签）实时预览关系标签的显示效果。
